var Channel=function(){"use strict";function a(a,b,c,d){function f(b){for(var c=0;c<b.length;c++)if(b[c].win===a)return!0;return!1}var g=!1;if("*"===b){for(var h in e)if(e.hasOwnProperty(h)&&"*"!==h&&"object"==typeof e[h][c]&&(g=f(e[h][c])))break}else e["*"]&&e["*"][c]&&(g=f(e["*"][c])),!g&&e[b]&&e[b][c]&&(g=f(e[b][c]));if(g)throw"A channel is already bound to the same window which overlaps with origin '"+b+"' and has scope '"+c+"'";"object"!=typeof e[b]&&(e[b]={}),"object"!=typeof e[b][c]&&(e[b][c]=[]),e[b][c].push({win:a,handler:d})}function b(a,b,c){for(var d=e[b][c],f=0;f<d.length;f++)d[f].win===a&&d.splice(f,1);0===e[b][c].length&&delete e[b][c]}function c(a){return Array.isArray?Array.isArray(a):-1!=a.constructor.toString().indexOf("Array")}var d=Math.floor(1000001*Math.random()),e={},f={},g=function(a){try{var b=JSON.parse(a.data);if("object"!=typeof b||null===b)throw"malformed"}catch(a){return}var c,d,g,h=a.source,i=a.origin;if("string"==typeof b.method){var j=b.method.split("::");2==j.length?(c=j[0],g=j[1]):g=b.method}if("undefined"!=typeof b.id&&(d=b.id),"string"==typeof g){var k=!1;if(e[i]&&e[i][c])for(var l=0;l<e[i][c].length;l++)if(e[i][c][l].win===h){e[i][c][l].handler(i,g,b),k=!0;break}if(!k&&e["*"]&&e["*"][c])for(var l=0;l<e["*"][c].length;l++)if(e["*"][c][l].win===h){e["*"][c][l].handler(i,g,b);break}}else"undefined"!=typeof d&&f[d]&&f[d](i,g,b)};return window.addEventListener?window.addEventListener("message",g,!1):window.attachEvent&&window.attachEvent("onmessage",g),{build:function(e){var g=function(a){if(e.debugOutput&&window.console&&window.console.log){try{"string"!=typeof a&&(a=JSON.stringify(a))}catch(b){}console.log("["+j+"] "+a)}};if(!window.postMessage)throw"jschannel cannot run this browser, no postMessage";if(!window.JSON||!window.JSON.stringify||!window.JSON.parse)throw"jschannel cannot run this browser, no JSON parsing/serialization";if("object"!=typeof e)throw"Channel build invoked without a proper object argument";if(!e.window||!e.window.postMessage)throw"Channel.build() called without a valid window argument";if(window===e.window)throw"target window is same as present window -- not allowed";var h=!1;if("string"==typeof e.origin){var i;"*"===e.origin?h=!0:null!==(i=e.origin.match(/^https?:\/\/(?:[-a-zA-Z0-9_\.])+(?::\d+)?/))&&(e.origin=i[0].toLowerCase(),h=!0)}if(!h)throw"Channel.build() called with an invalid origin";if("undefined"!=typeof e.scope){if("string"!=typeof e.scope)throw"scope, when specified, must be a string";if(e.scope.split("::").length>1)throw"scope may not contain double colons: '::'"}var j=function(){for(var a="",b="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",c=0;5>c;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}(),k={},l={},m={},n=!1,o=[],p=function(a,b,c){var d=!1,e=!1;return{origin:b,invoke:function(b,d){if(!m[a])throw"attempting to invoke a callback of a nonexistent transaction: "+a;for(var e=!1,f=0;f<c.length;f++)if(b===c[f]){e=!0;break}if(!e)throw"request supports no such callback '"+b+"'";t({id:a,callback:b,params:d})},error:function(b,c){if(e=!0,!m[a])throw"error called for nonexistent message: "+a;delete m[a],t({id:a,error:b,message:c})},complete:function(b){if(e=!0,!m[a])throw"complete called for nonexistent message: "+a;delete m[a],t({id:a,result:b})},delayReturn:function(a){return"boolean"==typeof a&&(d=a===!0),d},completed:function(){return e}}},q=function(a,b,c){return window.setTimeout(function(){if(l[a]){var d="timeout ("+b+"ms) exceeded on method '"+c+"'";l[a].error("timeout_error",d),delete l[a],delete f[a]}},b)},r=function(a,b,d){if("function"==typeof e.gotMessageObserver)try{e.gotMessageObserver(a,d)}catch(h){g("gotMessageObserver() raised an exception: "+h.toString())}if(d.id&&b){if(k[b]){var i=p(d.id,a,d.callbacks?d.callbacks:[]);m[d.id]={};try{if(d.callbacks&&c(d.callbacks)&&d.callbacks.length>0)for(var j=0;j<d.callbacks.length;j++){for(var n=d.callbacks[j],o=d.params,q=n.split("/"),r=0;r<q.length-1;r++){var s=q[r];"object"!=typeof o[s]&&(o[s]={}),o=o[s]}o[q[q.length-1]]=function(){var a=n;return function(b){return i.invoke(a,b)}}()}var t=k[b](i,d.params);i.delayReturn()||i.completed()||i.complete(t)}catch(h){var u="runtime_error",v=null;if("string"==typeof h?v=h:"object"==typeof h&&(h&&c(h)&&2==h.length?(u=h[0],v=h[1]):"string"==typeof h.error&&(u=h.error,h.message?"string"==typeof h.message?v=h.message:h=h.message:v="")),null===v)try{v=JSON.stringify(h),"undefined"==typeof v&&(v=h.toString())}catch(w){v=h.toString()}i.error(u,v)}}}else d.id&&d.callback?l[d.id]&&l[d.id].callbacks&&l[d.id].callbacks[d.callback]?l[d.id].callbacks[d.callback](d.params):g("ignoring invalid callback, id:"+d.id+" ("+d.callback+")"):d.id?l[d.id]?(d.error?l[d.id].error(d.error,d.message):void 0!==d.result?l[d.id].success(d.result):l[d.id].success(),delete l[d.id],delete f[d.id]):g("ignoring invalid response: "+d.id):b&&k[b]&&k[b]({origin:a},d.params)};a(e.window,e.origin,"string"==typeof e.scope?e.scope:"",r);var s=function(a){return"string"==typeof e.scope&&e.scope.length&&(a=[e.scope,a].join("::")),a},t=function(a,b){if(!a)throw"postMessage called with null message";var c=n?"post  ":"queue ";if(g(c+" message: "+JSON.stringify(a)),b||n){if("function"==typeof e.postMessageObserver)try{e.postMessageObserver(e.origin,a)}catch(d){g("postMessageObserver() raised an exception: "+d.toString())}e.window.postMessage(JSON.stringify(a),e.origin)}else o.push(a)},u=function(a,b){if(g("ready msg received"),n)throw"received ready message while in ready state.  help!";for(j+="ping"===b?"-R":"-L",v.unbind("__ready"),n=!0,g("ready msg accepted."),"ping"===b&&v.notify({method:"__ready",params:"pong"});o.length;)t(o.pop());"function"==typeof e.onReady&&e.onReady(v)},v={unbind:function(a){if(k[a]){if(!delete k[a])throw"can't delete method: "+a;return!0}return!1},bind:function(a,b){if(!a||"string"!=typeof a)throw"'method' argument to bind must be string";if(!b||"function"!=typeof b)throw"callback missing from bind params";if(k[a])throw"method '"+a+"' is already bound!";return k[a]=b,this},call:function(a){if(!a)throw"missing arguments to call function";if(!a.method||"string"!=typeof a.method)throw"'method' argument to call must be string";if(!a.success||"function"!=typeof a.success)throw"'success' callback missing from call";var b={},c=[],e=function(a,d){if("object"==typeof d)for(var f in d)if(d.hasOwnProperty(f)){var g=a+(a.length?"/":"")+f;"function"==typeof d[f]?(b[g]=d[f],c.push(g),delete d[f]):"object"==typeof d[f]&&e(g,d[f])}};e("",a.params);var g={id:d,method:s(a.method),params:a.params};c.length&&(g.callbacks=c),a.timeout&&q(d,a.timeout,s(a.method)),l[d]={callbacks:b,error:a.error,success:a.success},f[d]=r,d++,t(g)},notify:function(a){if(!a)throw"missing arguments to notify function";if(!a.method||"string"!=typeof a.method)throw"'method' argument to notify must be string";t({method:s(a.method),params:a.params})},destroy:function(){b(e.window,e.origin,"string"==typeof e.scope?e.scope:""),window.removeEventListener?window.removeEventListener("message",r,!1):window.detachEvent&&window.detachEvent("onmessage",r),n=!1,k={},m={},l={},e.origin=null,o=[],g("channel destroyed"),j=""}};return v.bind("__ready",u),setTimeout(function(){t({method:s("__ready"),params:"ping"},!0)},0),v}}}();!function(a){"use strict";var b=a.prototype,c=b.parseFromString;try{if((new a).parseFromString("","text/html"))return}catch(d){}b.parseFromString=function(a,b){var d,e,f,g;return/^\s*text\/html\s*(?:;|$)/i.test(b)?(e=document.implementation.createHTMLDocument(""),f=e.documentElement,f.innerHTML=a,g=f.firstElementChild,1===f.childElementCount&&"html"===g.localName.toLowerCase()&&e.replaceChild(g,f),d=e):d=c.apply(this,arguments),d}}(DOMParser),"function"!=typeof document.contains&&(Document.prototype.contains=function(a){return a===this||a.parentNode===this?!0:this.documentElement.contains(a)}),function(a,b,c,d,e,f,g){"use strict";function h(a){var b=a.indexOf("#");return b>0&&(a=a.substring(0,b)),a}function i(b){if(b.constructor===XMLHttpRequest&&(b={readyState:b.readyState,status:b.status,statusText:b.statusText,response_headers:b.getAllResponseHeaders()}),b.constructor===Array||b.constructor===String||b.constructor===Object)try{b=JSON.stringify(b)}catch(c){}a.getElementsByTagName("body")[0].textContent=b,console.error(b.stack),console.error(b)}function j(a){if(this.name="resolved",void 0!==a&&"string"!=typeof a)throw new TypeError("You must pass a string.");this.message=a||"Default Message"}function k(){return this instanceof k?void 0:new k}function l(a){void 0!==a.__monitor&&a.__monitor.cancel(),a.__monitor=new z,a.__monitor.fail(function(b){return b instanceof c.CancellationError?void 0:a.aq_reportServiceError(b)}).fail(function(a){return i(a)})}function m(a){a.__sub_gadget_dict={},l(a)}function n(a){var b,d,e,f,g,h=a.__element.querySelectorAll("[data-gadget-scope]"),i=[];for(g=0;g<h.length;g+=1)b=h[g],d=b.getAttribute("data-gadget-scope"),e=b.getAttribute("data-gadget-url"),f=b.getAttribute("data-gadget-sandbox"),null!==d&&null!==e&&i.push(a.declareGadget(e,{element:b,scope:d||void 0,sandbox:f||void 0}));return c.all(i)}function o(a){a.__monitor.monitor((new c.Queue).push(function(){var b,c=a.constructor.__service_list;for(b=0;b<c.length;b+=1)a.__monitor.monitor(c[b].apply(a))}))}function p(a,b,d){var e,f,g=this;for(e in g.__sub_gadget_dict)g.__sub_gadget_dict.hasOwnProperty(e)&&g.__sub_gadget_dict[e]===a&&(f=e);return(new c.Queue).push(function(){var a=g.__acquired_method_dict||{};if(a.hasOwnProperty(b))return a[b].apply(g,[d,f]);throw new y.AcquisitionError("aq_dynamic is not defined")}).push(void 0,function(a){if(a instanceof y.AcquisitionError)return g.__aq_parent(b,d);throw a})}function q(a,b){a.__aq_parent=function(c,d){return p.apply(b,[a,c,d])}}function r(){return this instanceof r?void k.call(this):new r}function s(b,d,e){function f(a,b){return function(){return a(b)}}var g;return void 0===d.element&&(d.element=a.createElement("div")),(new c.Queue).push(function(){return y.declareGadgetKlass(b)}).push(function(a){var b,f=a.__template_element.body.childNodes;for(w=a,g=new a,g.__element=d.element,b=0;b<f.length;b+=1)g.__element.appendChild(f[b].cloneNode(!0));return q(g,e),c.all([g.getRequiredJSList(),g.getRequiredCSSList()])}).push(function(a){var b,d=new c.Queue;for(b=0;b<a[0].length;b+=1)d.push(f(y.declareJS,a[0][b]));for(b=0;b<a[1].length;b+=1)d.push(f(y.declareCSS,a[1][b]));return d}).push(function(){return g})}function t(){return this instanceof t?void k.call(this):new t}function u(b,d,f){var g,h,i=c.defer();if(void 0===d.element)throw new Error("DOM element is required to create Iframe Gadget "+b);if(!a.contains(d.element))throw new Error("The parent element is not attached to the DOM for "+b);return g=new t,q(g,f),h=a.createElement("iframe"),h.setAttribute("src",b),g.__path=b,g.__element=d.element,d.element.appendChild(h),g.__chan=e.build({window:h.contentWindow,origin:"*",scope:"renderJS"}),g.__chan.bind("declareMethod",function(a,b){return g[b]=function(){var a=arguments,d=new c.Promise(function(c,d){g.__chan.call({method:"methodCall",params:[b,Array.prototype.slice.call(a,0)],success:function(a){c(a)},error:function(a){d(a)}})});return(new c.Queue).push(function(){return d})},"OK"}),g.__chan.bind("ready",function(){return i.resolve(g),"OK"}),g.__chan.bind("failed",function(a,b){return i.reject(b),"OK"}),g.__chan.bind("acquire",function(a,b){g.__aq_parent.apply(g,b).then(function(b){a.complete(b)}).fail(function(b){a.error(b.toString())}),a.delayReturn(!0)}),c.any([i.promise,c.timeout(5e3)])}function v(){var d,j,m,n,p,s,t,u=h(b.location.href),v=new c.Queue,z=0,D=!1;if(A.hasOwnProperty(u))throw new Error("bootstrap should not be called twice");x=new c.Promise(function(h,s){function v(){var b,e,i=y.parseGadgetHTMLDocument(a,u);for(e in i)i.hasOwnProperty(e)&&(d.prototype["__"+e]=i[e]);for(d.__template_element=a.createElement("div"),j.__element=a.body,b=0;b<j.__element.childNodes.length;b+=1)d.__template_element.appendChild(j.__element.childNodes[b].cloneNode(!0));c.all([j.getRequiredJSList(),j.getRequiredCSSList()]).then(function(a){var b,c=a[0],d=a[1];for(b=0;b<c.length;b+=1)B[c[b]]=null;for(b=0;b<d.length;b+=1)C[d[b]]=null;w=void 0}).then(function(){var b=a.querySelector("body"),c=new f(function(b){var c,d,e,f,h,i;b.forEach(function(b){if("childList"===b.type){for(e=b.removedNodes.length,c=0;e>c;c+=1)if(h=b.removedNodes[c],h.nodeType===g.ELEMENT_NODE)for(h.hasAttribute("data-gadget-url")&&void 0!==h._gadget&&l(h._gadget),i=h.querySelectorAll("[data-gadget-url]"),f=i.length,d=0;f>d;d+=1)h=i[d],void 0!==h._gadget&&l(h._gadget);for(e=b.addedNodes.length,c=0;e>c;c+=1)if(h=b.addedNodes[c],h.nodeType===g.ELEMENT_NODE)for(h.hasAttribute("data-gadget-url")&&void 0!==h._gadget&&a.contains(h)&&o(h._gadget),i=h.querySelectorAll("[data-gadget-url]"),f=i.length,d=0;f>d;d+=1)h=i[d],a.contains(h)&&void 0!==h._gadget&&o(h._gadget)}})}),d={childList:!0,subtree:!0,attributes:!1,characterData:!1};return c.observe(b,d),j}).then(h,function(a){throw s(a),console.error(a),a})}t=new k,t.__acquired_method_dict={getTopURL:function(){return u},reportServiceError:function(a){i(a[0])}},t.__aq_parent=function(a){throw new y.AcquisitionError("No gadget provides "+a)},b.self===b.top?(d=function(){k.call(this)},d.declareMethod=k.declareMethod,d.declareAcquiredMethod=k.declareAcquiredMethod,d.allowPublicAcquisition=k.allowPublicAcquisition,d.__ready_list=k.__ready_list.slice(),d.ready=k.ready,d.__service_list=k.__service_list.slice(),d.declareService=k.declareService,d.prototype=new k,d.prototype.constructor=d,d.prototype.__path=u,A[u]=d,j=new A[u],q(j,t)):(m=e.build({window:b.parent,origin:"*",scope:"renderJS"}),d=r,d.__ready_list=k.__ready_list.slice(),d.__service_list=k.__service_list.slice(),d.prototype.__path=u,j=new r,n=function(){0===z&&D===!0&&m.notify({method:"ready"})},p=function(a){z+=1,m.call({method:"declareMethod",params:a,success:function(){z-=1,n()},error:function(){z-=1}})},p("getInterfaceList"),p("getRequiredCSSList"),p("getRequiredJSList"),p("getPath"),p("getTitle"),d.declareMethod=function(a,b){var c=k.declareMethod.apply(this,[a,b]);return p(a),c},d.declareService=k.declareService,d.declareAcquiredMethod=k.declareAcquiredMethod,d.allowPublicAcquisition=k.allowPublicAcquisition,d.prototype.__aq_parent=function(a,b,d){return new c.Promise(function(c,e){m.call({method:"acquire",params:[a,b],success:function(a){c(a)},error:function(a){e(a)},timeout:d})})}),d.prototype.__acquired_method_dict={},w=d,a.addEventListener("DOMContentLoaded",v,!1)}),v.push(function(){return x}).push(function(c){function e(){return c}var f;for(b.top!==b.self&&d.__ready_list.splice(1,0,function(){return c.__aq_parent("getTopURL",[],100).then(function(b){var d=a.createElement("base");d.href=b,d.target="_top",a.head.appendChild(d),m.bind("methodCall",function(a,b){c[b[0]].apply(c,b[1]).then(function(b){a.complete(b)}).fail(function(b){a.error(b.toString())}),a.delayReturn(!0)})}).fail(function(a){if("timeout_error"!==a)throw a;s=!0,q(c,t)})}),d.ready(function(a){return o(a)}),v.push(e),f=0;f<d.__ready_list.length;f+=1)v.push(d.__ready_list[f]).push(e)}),b.self===b.top?v.fail(function(a){throw i(a),a}):v.then(function(){D=!0,n()}).fail(function(a){throw s?i(a):m.notify({method:"failed",params:a.toString()}),a})}var w,x,y,z,A={},B={},C={};j.prototype=new Error,j.prototype.constructor=j,z=function(){function a(){var a,b=h.length;for(a=0;b>a;a+=1)h[a].cancel();h=[]}var b,d,e,f,g=this,h=[];return this instanceof z?(b=new c.Promise(function(b,c,h){d=function(b){return f?void 0:(g.isRejected=!0,g.rejectedReason=b,f=!0,a(),c(b))},e=h},a),g.cancel=function(){f||(f=!0,b.cancel(),b.fail(function(a){g.isRejected=!0,g.rejectedReason=a}))},g.then=function(){return b.then.apply(b,arguments)},g.fail=function(){return b.fail.apply(b,arguments)},void(g.monitor=function(a){if(f)throw new j;var b=(new c.Queue).push(function(){return a}).push(function(){var a,b,c=h.length,d=[];for(b=0;c>b;b+=1)a=h[b],a.isFulfilled||a.isRejected||d.push(a);h=d},function(b){throw b instanceof c.CancellationError&&(a.isFulfilled&&a.isRejected||a.cancel()),d(b),b},function(a){return e(a),a});return h.push(b),this})):new z},z.prototype=Object.create(c.Promise.prototype),z.prototype.constructor=z,k.prototype.__title="",k.prototype.__interface_list=[],k.prototype.__path="",k.prototype.__html="",k.prototype.__required_css_list=[],k.prototype.__required_js_list=[],k.__ready_list=[m,n],k.ready=function(a){return this.__ready_list.push(a),this},k.__service_list=[],k.declareService=function(a){return this.__service_list.push(a),this},k.declareMethod=function(a,b){return this.prototype[a]=function(){var a=this,d=arguments;return(new c.Queue).push(function(){return b.apply(a,d)})},this},k.declareMethod("getInterfaceList",function(){return this.__interface_list}).declareMethod("getRequiredCSSList",function(){return this.__required_css_list}).declareMethod("getRequiredJSList",function(){return this.__required_js_list}).declareMethod("getPath",function(){return this.__path}).declareMethod("getTitle",function(){return this.__title}).declareMethod("getElement",function(){if(void 0===this.__element)throw new Error("No element defined");return this.__element}),k.declareAcquiredMethod=function(a,b){return this.prototype[a]=function(){var a=Array.prototype.slice.call(arguments,0),d=this;return(new c.Queue).push(function(){return d.__aq_parent(b,a)})},this},k.declareAcquiredMethod("aq_reportServiceError","reportServiceError"),k.allowPublicAcquisition=function(a,b){return this.prototype.__acquired_method_dict[a]=b,this},r.__ready_list=k.__ready_list.slice(),r.__service_list=k.__service_list.slice(),r.ready=k.ready,r.declareService=k.declareService,r.prototype=new k,r.prototype.constructor=r,t.__ready_list=k.__ready_list.slice(),t.ready=k.ready,t.__service_list=k.__service_list.slice(),t.declareService=k.declareService,t.prototype=new k,t.prototype.constructor=t,k.declareMethod("declareGadget",function(b,d){var e,f,g=this,h=x;return void 0===d&&(d={}),void 0===d.sandbox&&(d.sandbox="public"),b=y.getAbsoluteURL(b,this.__path),x=(new c.Queue).push(function(){return h}).push(void 0,function(){}).push(function(){var a;if("public"===d.sandbox)a=s;else{if("iframe"!==d.sandbox)throw new Error("Unsupported sandbox options '"+d.sandbox+"'");a=u}return a(b,d,g)}).push(function(a){return w=void 0,a}).push(void 0,function(a){throw w=void 0,a}),f=x,e=(new c.Queue).push(function(){return f}).push(function(c){function f(){return c}var h;for(h=0;h<c.constructor.__ready_list.length;h+=1)e.push(c.constructor.__ready_list[h]),e.push(f);return void 0!==d.scope&&(g.__sub_gadget_dict[d.scope]=c,c.__element.setAttribute("data-gadget-scope",d.scope)),c.__element.setAttribute("data-gadget-url",b),c.__element.setAttribute("data-gadget-sandbox",d.sandbox),c.__element._gadget=c,a.contains(c.__element)&&e.push(o),e.push(f),c})}).declareMethod("getDeclaredGadget",function(a){if(!this.__sub_gadget_dict.hasOwnProperty(a))throw new Error("Gadget scope '"+a+"' is not known.");return this.__sub_gadget_dict[a]}).declareMethod("dropGadget",function(a){if(!this.__sub_gadget_dict.hasOwnProperty(a))throw new Error("Gadget scope '"+a+"' is not known.");delete this.__sub_gadget_dict[a]}),y=function(a){var c;if(a===b&&(c=w),void 0===c)throw new Error("Unknown selector '"+a+"'");return c},y.AcquisitionError=function(a){if(this.name="AcquisitionError",void 0!==a&&"string"!=typeof a)throw new TypeError("You must pass a string.");this.message=a||"Acquisition failed"},y.AcquisitionError.prototype=new Error,y.AcquisitionError.prototype.constructor=y.AcquisitionError,y.getAbsoluteURL=function(a,b){var c,e,f,g="<!doctype><html><head></head></html>",h=new RegExp("^(?:[a-z]+:)?//|data:","i");return a&&b&&!h.test(a)?(c=(new d).parseFromString(g,"text/html"),e=c.createElement("base"),f=c.createElement("link"),c.head.appendChild(e),c.head.appendChild(f),e.href=b,f.href=a,f.href):a},y.declareJS=function(b){var d;return d=B.hasOwnProperty(b)?c.resolve():new c.Promise(function(c,d){var e;e=a.createElement("script"),e.type="text/javascript",e.src=b,e.onload=function(){B[b]=null,c()},e.onerror=function(a){d(a)},a.head.appendChild(e)})},y.declareCSS=function(b){var d;return d=C.hasOwnProperty(b)?c.resolve():new c.Promise(function(c,d){var e;e=a.createElement("link"),e.rel="stylesheet",e.type="text/css",e.href=b,e.onload=function(){C[b]=null,c()},e.onerror=function(a){d(a)},a.head.appendChild(e)})},y.declareGadgetKlass=function(a){function b(){var b,c,e;if(!A.hasOwnProperty(a)){b=function(){k.call(this)},b.__ready_list=k.__ready_list.slice(),b.__service_list=k.__service_list.slice(),b.declareMethod=k.declareMethod,b.declareAcquiredMethod=k.declareAcquiredMethod,b.allowPublicAcquisition=k.allowPublicAcquisition,b.ready=k.ready,b.declareService=k.declareService,b.prototype=new k,b.prototype.constructor=b,b.prototype.__path=a,b.prototype.__acquired_method_dict={},b.__template_element=(new d).parseFromString(h.responseText,"text/html"),e=y.parseGadgetHTMLDocument(b.__template_element,a);for(c in e)e.hasOwnProperty(c)&&(b.prototype["__"+c]=e[c]);A[a]=b}return A[a]}function e(c,d){function e(){var a;try{0===h.readyState?d(h):4===h.readyState&&(h.status<200||h.status>=300||!/^text\/html[;]?/.test(h.getResponseHeader("Content-Type")||"")?d(h):(a=b(),c(a)))}catch(e){d(e)}}h=new XMLHttpRequest,h.open("GET",a),h.onreadystatechange=e,h.setRequestHeader("Accept","text/html"),h.withCredentials=!0,h.send()}function f(){void 0!==h&&h.readyState!==h.DONE&&h.abort()}var g,h;return g=A.hasOwnProperty(a)?c.resolve(A[a]):new c.Promise(e,f)},y.clearGadgetKlassList=function(){A={},B={},C={}},y.parseGadgetHTMLDocument=function(a,b){var c,d,e={title:"",interface_list:[],required_css_list:[],required_js_list:[]},f=new RegExp("^(?:[a-z]+:)?//","i");if(!b||!f.test(b))throw new Error("The url should be absolute: "+b);if(9!==a.nodeType)throw new Error("The first parameter should be an HTMLDocument");if(e.title=a.title,null!==a.head)for(c=0;c<a.head.children.length;c+=1)d=a.head.children[c],null!==d.href&&("stylesheet"===d.rel?e.required_css_list.push(y.getAbsoluteURL(d.getAttribute("href"),b)):"SCRIPT"!==d.nodeName||"text/javascript"!==d.type&&d.type?"http://www.renderjs.org/rel/interface"===d.rel&&e.interface_list.push(y.getAbsoluteURL(d.getAttribute("href"),b)):e.required_js_list.push(y.getAbsoluteURL(d.getAttribute("src"),b)));return e},b.rJS=b.renderJS=y,b.__RenderJSGadget=k,b.__RenderJSEmbeddedGadget=r,b.__RenderJSIframeGadget=t,v()}(document,window,RSVP,DOMParser,Channel,MutationObserver,Node);